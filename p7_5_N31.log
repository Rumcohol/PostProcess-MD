#atom_style bond #no stiffness
atom_style angle #with stiffness

boundary        p p p
###
# Pair interactions require lists of neighbours to be calculated
###

#neighbor 0.3 bin
neighbor 4 bin

neigh_modify every 1 delay 1 check yes
atom_modify sort 0 0
### Generate RESTART file, SPECIAL format, not a .txt file ###
### Useful if simulation crashes ###

restart 10000 p7_5_N31.restart
#############################



### READ "start" data file ###

read_data p7_5_N31.dat
Reading data file ...
  orthogonal box = (-1000.0000 -1000.0000 -1000.0000) to (1000.0000 1000.0000 1000.0000)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  31 atoms
  scanning bonds ...
  1 = max bonds/atom
  scanning angles ...
  1 = max angles/atom
  reading bonds ...
  31 bonds
  reading angles ...
  31 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     2 = max # of 1-2 neighbors
     2 = max # of 1-3 neighbors
     4 = max # of 1-4 neighbors
     6 = max # of special neighbors
  special bonds CPU = 0.002 seconds
  read_data CPU = 0.023 seconds

######################

### READ "REstart" data file ###

######################



###
# Define groups (atom type 1 is group 'all')
###
group all type 1
31 atoms in group all


###
# Dump configs - "simple dumpings"
###

###
# Dump configs + box coords
###

dump   1   all   custom   1000  p7_5_N31.lammpstrj  id  x y z  ix iy iz
dump_modify   1   format line "%d %.5f %.5f %.5f %d %d %d"

########################################################################


###################################################################
# Stiffness term
#
# E = K * (1+cos(theta)), K>0
#
angle_style   cosine
#change this coefficient to change stiffness (e.g. 1,5,10)
angle_coeff   1 1.0
###################################################################

###################################################################
# Pair interaction between non-bonded atoms
#
#  Lennard-Jones 12-6 potential with cutoff:
#  potential E=4epsilon[ (sigma/r)^12 - (sigma/r)^6]  for r<r_cut
#
#  1.12246 = 2^(1/6) is the minimum of the potential


pair_style      lj/cut 1.12246152962189
#pair_style      lj/cut 3

#
#  pair_modify shift yes adds a constant to the potential such

#  that E(r_cut)=0. Forces remains unchanged.
#

pair_modify     shift yes

#
#  pair_coeff for lj/cut, specify 4:
#    * atom type interacting with
#    * atom type
#    * epsilon (energy units)
#    * sigma (distance units)
#

pair_coeff      1 1 1.0 1.0
###################################################################

###################################################################
# Pair interaction between non-bonded atoms
#
#  soft potential, for PUSHING apart overlapping atoms
#  potential E=A*(1 + cos(pi*r/r_c))
#
#  1.12246 = 2^(1/6) is the cut-off r_c

#pair_style     soft 1.12246152962189

#
#  pair_coeff for soft, specify 3:
#    * atom type interacting with
#    * atom type
#    * A
#
#

#pair_coeff      1 1 100.0
###################################################################

###################################################################
# Pair interaction between bonded atoms
#
# Fene potential + Lennard Jones 12-6:

#
#  E= - 0.5 K R0^2 ln[ 1- (r/R0)^2]
#     + 4epsilon[ (sigma/r)^12 - (sigma/r)^6] + epsilon
#

bond_style   fene


#
# For style fene, specify:
#   * bond type
#   * K (energy/distance^2)
#   * R0 (distance)
#   * epsilon (energy)  (LJ component)
#   * sigma (distance)  (LJ component)
#


special_bonds fene #<=== I M P O R T A N T (new command)
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        1        1       
  special bond factors coul:  0        1        1       
     2 = max # of 1-2 neighbors
     6 = max # of special neighbors
  special bonds CPU = 0.007 seconds

bond_coeff   1   30   1.5   1.0   1.0


###################################################

###################################################################
# Pair interaction between bonded atoms
#
# Harmonic potential:
#
#  E= K * (R-R0)^2
#

#bond_style   harmonic

#
# For style harmonic, specify:
#   * bond type
#   * K (energy/distance^2)
#   * R0 (distance)
#

#bond_coeff   1   60.0   1.0
#bond_coeff   2   harmonic 0.1   1.0

###################################################
compute 1 all gyration
#compute 2 all coord/atom cutoff 1.1

#dump 2 all custom 10000 contact_number.dump id c_2


###
# Set up fixes
###
thermo_style   custom   step  temp enthalpy c_1
fix 1 all nve   ###NVE ensemble

fix 2 all   langevin   1.0 1.0 1.0  278111   ###Langevin integrator Tstart Tstop 1/friction rndseed


##### Sample thermodynamic info  (temperature, energy, pressure, etc.) #####
thermo 1000









############################################################################

###
# set timestep of integrator

timestep 0.01

###
# run integration for a number of steps
###
#run 0
#variable r equal c_1
#if "$r < 63.1" then "quit 1"
run 2000000
Neighbor list info ...
  update every 1 steps, delay 1 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.1224615
  ghost atom cutoff = 5.1224615
  binsize = 2.5612308, bins = 781 781 781
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d/newton
      bin: standard
WARNING: Communication cutoff 5.12246152962189 is shorter than a bond length based estimate of 5.455. This may lead to errors. (src/comm.cpp:667)
Per MPI rank memory allocation (min/avg/max) = 1859.0 | 1859.0 | 1859.0 Mbytes
Step Temp Enthalpy c_1 
       0            0    103.11202    1.8458438 
WARNING: FENE bond too long: 3 16 17 1.4574460299406895 (src/MOLECULE/bond_fene.cpp:88)
WARNING: FENE bond too long: 4 15 16 1.4359706169468567 (src/MOLECULE/bond_fene.cpp:88)
WARNING: FENE bond too long: 4 16 17 1.4978417814653322 (src/MOLECULE/bond_fene.cpp:88)
WARNING: FENE bond too long: 5 16 17 1.4346198182978358 (src/MOLECULE/bond_fene.cpp:88)
    1000    1.0642012    26.418845    1.6347018 
    2000    1.1837082    29.157974    1.6168354 
    3000   0.98366374    26.866263     1.619516 
    4000    1.1088738    24.253541    1.6088387 
    5000    1.3197427    23.137289    1.5841913 
    6000    0.9120432    21.925211    1.6233586 
    7000   0.87580516    22.636309     1.614414 
    8000   0.95036194    24.356287     1.599282 
    9000    0.8438973    21.483067    1.6012616 
   10000   0.91538845     26.12566    1.5697405 
   11000   0.91423505    25.605828     1.580095 
   12000    1.1274191    29.651047    1.5586923 
   13000    1.2195943    25.054866    1.5383143 
   14000    1.0184806    25.241827    1.6211682 
   15000    1.0251863    20.701842      1.62819 
   16000    1.0982854    24.580708    1.5804341 
   17000    1.1082749    21.963261    1.6167041 
   18000    0.9981662     23.50565    1.6099717 
   19000    1.1435572    20.352387    1.6174295 
   20000    1.1398028    21.012742    1.6233723 
   21000   0.92204835    23.440894     1.594594 
